<p-button (onClick)="test()">Test</p-button>
<p-messages [(value)]="messagesToDisplay"></p-messages>

<table>
    <tr *ngFor="let line of lines">
        <td>
            <button (click)="deleteLine(line)">{{line.link.from}} > {{line.link.to}}</button>
        </td>
    </tr>
</table>

<div class="draggableArea">
    <div id="tableContainer" *ngFor="let schematic of schematics; index as i" cdkDrag
         (cdkDragMoved)="recalculateLine()">
        <div class="dot"><a (click)="handleTableClick(i)">+</a></div>
        <p-table
            #tableRef
            [id]="i"
            class="p-datatable-sm p-4"
            [columns]="schematic.headers" [value]="schematic.headers"
            autoLayout="true"
        >

            <ng-template pTemplate="header">
                <tr class="tableHeader">
                    <th
                        *ngFor="let header of schematic.headers; index as j">{{header.name}}
                        <p-dropdown
                            *ngIf="schematic.fact"
                            [options]="getLinkedHeaders(i) | async"
                            optionLabel="header"
                            [(ngModel)]="selectedHeader[i][j]"
                            (onChange)="setKeys(i, j)"
                            appendTo="body">
                        </p-dropdown>
                    </th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body">
                <tr>
                    <td *ngFor="let header of schematic.headers">{{header.type}}</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="summary">
                <div>Index : {{i}}</div>
                <p-checkbox (onChange)="handleTableStatusChange()" [binary]="true" [(ngModel)]="schematic.fact"
                            label="Table de fait"></p-checkbox>
            </ng-template>
        </p-table>
    </div>
</div>

<p-button id="saveButton" (onClick)="saveSchematics()">Enregistrer le schÃ©ma</p-button>
